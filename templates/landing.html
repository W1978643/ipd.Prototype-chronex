<!DOCTYPE html>
<html lang="en">
<head>
    <!-- ==== Document Meta & Resources ==== -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Chronex - Student Productivity</title>
    <!-- Link to main stylesheet - uses Flask url_for for dynamic path -->
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
</head>
<body>
    <!-- ==== Cosmic Background ==== -->
    <!-- Decorative fixed background elements creating space theme -->
    <div class="cosmic-background"></div>  <!-- Purple gradient glow -->
    <div class="stars-decoration"></div>   <!-- Tiled star pattern -->

    <!-- ==== Landing Page Header ==== -->
    <!-- Simplified header for public page - logo and sign in button only -->
    <header class="landing-page-header">
        <div class="site-logo">Chronex</div>
        <button class="button button-primary" onclick="showLoginModal()">Sign In</button>
    </header>

    <!-- ==== Hero Section ==== -->
    <!-- 
        Main landing page content - full viewport height
        Centered branding with call-to-action button
        Displayed to users before authentication
    -->
    <section class="hero-section">
        <h1 class="hero-main-title">Chronex</h1>
        <p class="hero-description">Your all-in-one student productivity companion. Manage tasks, track focus time, take notes, and achieve your goals.</p>
        <button class="button button-primary" onclick="showLoginModal()">Get Started</button>
    </section>

    <!-- ==== Login/Register Modal ==== -->
    <!-- 
        Popup dialog containing authentication forms
        Three tabs: Sign In, Register, Password Reset
        Visibility controlled by JavaScript (.active class)
    -->
    <div class="modal-backdrop" id="loginModalBackdrop">
        <div class="login-modal-content">
            
            <!-- Tab Navigation - Switches between form panels -->
            <div class="login-tab-buttons">
                <div class="login-tab-button active" data-tab="login" onclick="switchLoginTab('login')">Sign In</div>
                <div class="login-tab-button" data-tab="register" onclick="switchLoginTab('register')">Register</div>
                <div class="login-tab-button" data-tab="forgot" onclick="switchLoginTab('forgot')">Reset</div>
            </div>

            <!-- ==== Sign In Form ==== -->
            <!-- Authenticates existing users - POST to handle_login route -->
            <form class="login-form-panel active" id="signInForm" action="{{ url_for('handle_login') }}" method="POST">
                <div class="input-group">
                    <label class="input-label">Username or Email</label>
                    <input type="text" name="email" class="text-input" placeholder="Enter username or email" required>
                </div>
                <div class="input-group">
                    <label class="input-label">Password</label>
                    <input type="password" name="password" class="text-input" placeholder="Enter your password" required>
                </div>
                <!-- Quick link to password reset tab -->
                <a href="#" class="forgot-password-link" onclick="switchLoginTab('forgot'); return false;">Forgot password?</a>
                <button type="submit" class="button button-primary button-full-width">Sign In</button>
            </form>

            <!-- ==== Registration Form ==== -->
            <!-- Creates new user account - POST to handle_registration route -->
            <form class="login-form-panel" id="createAccountForm" action="{{ url_for('handle_registration') }}" method="POST">
                <div class="input-group">
                    <label class="input-label">Username</label>
                    <input type="text" name="username" class="text-input" placeholder="Choose a username" required>
                </div>
                <div class="input-group">
                    <label class="input-label">Email (optional)</label>
                    <input type="email" name="email" class="text-input" placeholder="Enter your email">
                </div>
                <div class="input-group">
                    <label class="input-label">Password</label>
                    <input type="password" name="password" class="text-input" placeholder="Create a password" required>
                </div>
                <div class="input-group">
                    <label class="input-label">Verify Password</label>
                    <input type="password" name="confirm_password" class="text-input" placeholder="Verify your password" required>
                </div>
                <button type="submit" class="button button-primary button-full-width">Create Account</button>
            </form>

            <!-- ==== Password Reset Form ==== -->
            <!-- Demo functionality - simulates password reset email -->
            <form class="login-form-panel" id="resetPasswordForm" action="{{ url_for('handle_forgot_password') }}" method="POST">
                <div class="input-group">
                    <label class="input-label">Email</label>
                    <input type="email" name="email" class="text-input" placeholder="Enter your email" required>
                </div>
                <p class="text-faded margin-bottom-medium" style="font-size: 0.85rem;">We'll send you a link to reset your password.</p>
                <button type="submit" class="button button-primary button-full-width">Send Reset Link</button>
            </form>

            <!-- Close modal button -->
            <button class="button button-secondary button-full-width margin-top-small" onclick="hideLoginModal()">Cancel</button>
        </div>
    </div>

    <!-- ==== Page Footer ==== -->
    <!-- Copyright and navigation links -->
    <footer class="page-footer">
        <div>Â© 2026 Chronex - Student Productivity App</div>
        <div class="footer-navigation">
            <a href="#" class="footer-navigation-link">About</a>
            <a href="#" class="footer-navigation-link">Privacy</a>
            <a href="#" class="footer-navigation-link">Terms</a>
        </div>
    </footer>

    <!-- ==== Flash Messages ==== -->
    <!-- 
        Server-side notifications (errors, success messages)
        Rendered by Jinja2 from Flask's flash() function
        Auto-displayed and hidden via JavaScript
    -->
    {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
            {% for category, message in messages %}
                <div class="toast-notification {{ category }}" id="notificationToast">{{ message }}</div>
            {% endfor %}
        {% endif %}
    {% endwith %}

    <!-- ==== JavaScript ==== -->
    <script>
        // ==========================================
        //   MODAL CONTROL FUNCTIONS
        // ==========================================

        /**
         * Show login/register popup modal
         * Adds .active class to display the backdrop
         */
        function showLoginModal() {
            document.getElementById('loginModalBackdrop').classList.add('active');
        }

        /**
         * Hide popup modal
         * Removes .active class to hide the backdrop
         */
        function hideLoginModal() {
            document.getElementById('loginModalBackdrop').classList.remove('active');
        }

        // ==========================================
        //   TAB SWITCHING
        // ==========================================

        /**
         * Switch between Login, Register, and Forgot Password forms
         * @param {string} selectedTabName - Tab identifier: 'login', 'register', or 'forgot'
         */
        function switchLoginTab(selectedTabName) {
            // Update tab button active states
            document.querySelectorAll('.login-tab-button').forEach(tabButton => {
                tabButton.classList.remove('active');
                if (tabButton.dataset.tab === selectedTabName) {
                    tabButton.classList.add('active');
                }
            });

            // Hide all form panels
            document.querySelectorAll('.login-form-panel').forEach(formPanel => {
                formPanel.classList.remove('active');
            });

            // Show selected form panel - map tab name to form ID
            const formIdMap = {
                'login': 'signInForm',
                'register': 'createAccountForm',
                'forgot': 'resetPasswordForm'
            };
            document.getElementById(formIdMap[selectedTabName]).classList.add('active');
        }

        // ==========================================
        //   EVENT LISTENERS
        // ==========================================

        // Close popup when clicking on dark overlay (outside modal content)
        document.getElementById('loginModalBackdrop').addEventListener('click', function(clickEvent) {
            if (clickEvent.target === this) {  // Only if clicking backdrop itself
                hideLoginModal();
            }
        });

        // ==========================================
        //   TOAST NOTIFICATION
        // ==========================================

        // Auto-show flash messages then fade out after 4 seconds
        const toastElement = document.getElementById('notificationToast');
        if (toastElement) {
            setTimeout(() => toastElement.classList.add('show'), 100);     // Show after 100ms
            setTimeout(() => toastElement.classList.remove('show'), 4000); // Hide after 4s
        }
    </script>
</body>
</html>
